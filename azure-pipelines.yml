trigger:
- main

pool:
  name: Default  # Replace with your custom agent pool name if different

steps:
- checkout: self

- task: UsePythonVersion@0
  inputs:
    versionSpec: '3.x'
    addToPath: true

- script: |
    echo "ðŸ“ Creating app directory on VM..."
    mkdir -p /home/vamsi/app
    cp app.py /home/vamsi/app/

    echo "ðŸš€ Installing Flask if needed..."
    python3 -m pip install --user flask

    echo "â–¶ï¸ Running Flask app..."
    nohup python3 /home/vamsi/app/app.py > /home/vamsi/app/output.log 2>&1 &

    echo "âœ… Deployment done!"
  displayName: 'Deploy and Run Flask App on VM'
